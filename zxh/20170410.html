<!DOCTYPE HTML><html><head><script>
	if('' == 'true'){
		if (prompt('请输入管理员密码') !== '025025'){
            alert('密码错误！');
            location.href='https://zxhtom.oschina.io';
    	}
	}
</script><meta charset=UTF-8><meta name=viewport content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><meta http-equiv=X-UA-Compatible content="IE=Edge,chrome=1"><meta http-equiv=Cache-Control content=no-siteapp><meta name=renderer content=webkit|ie-comp|ie-stand><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><meta name=format-detection content="telephone=no,email=no,adress=no"><meta name=browsermode content=application><meta name=screen-orientation content=portrait><link rel=dns-prefetch href=https://zxhtom.oschina.io><meta name=description content=张新华的个人网站><meta name=robots content=all><meta name=google content=all><meta name=googlebot content=all><meta name=verify content=all><title>Kafka集群配置---Windows版 | 烟花散尽13141</title><link rel=alternate href=/atom.xml title=烟花散尽13141 type=application/atom+xml><link rel=icon href=/favicon.ico><link rel=stylesheet href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css?rev=9.12.0"><link rel=stylesheet href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4"><link rel=stylesheet href=//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href="/css/style.css?rev=@@hash"><link rel=stylesheet href="/css/mycss.css?rev=@@hash"><div class=hide><script src="https://s4.cnzz.com/z_stat.php?id=1263868967&web_id=1263868967" language=JavaScript></script></div><script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?709c2dde1f61f5e589ff3ed31ba52411";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script></head><body><header class=main-header style=background-image:url(http://7xpw2b.com1.z0.glb.clouddn.com/hexo-sinppet/img/banner2.jpg)><div class=main-header-box><a class=header-avatar href="/"><img src=/img/avatar.jpg alt=logo头像></a><div class=branding><h2>学如逆水行舟，不进则退！！！</h2></div></div></header><nav class=main-navigation><div class=container><div class=row><div class=col-sm-12><div class=navbar-header><span class="nav-toggle-button collapsed" data-toggle=collapse data-target=#main-menu id=mnav><span class=sr-only>Toggle navigation</span> <i class="fa fa-bars"></i></span></div><div class="collapse navbar-collapse" id=main-menu><ul class=menu><li role=presentation><a href="/"><i class="fa fa-fw"></i>首页</a></li><li role=presentation><a href="/about/"><i class="fa fa-fw"></i>关于我</a></li><li role=presentation><a href="/tags/"><i class="fa fa-fw"></i>标签</a></li><li role=presentation><a href="/categories/"><i class="fa fa-fw"></i>分类</a></li><li role=presentation><a href="/archives/"><i class="fa fa-fw"></i>归档</a></li><li role=presentation><a href="/schedule/"><i class="fa fa-fw"></i>日程表</a></li><li role=presentation><a href=/sitemap.xml><i class="fa fa-fw"></i>地图导航</a></li><li role=presentation><a href="/404/"><i class="fa fa-fw"></i>公益活动</a></li></ul></div></div></div></div></nav><section class=content-wrap><div class=container><div class=row><main class="col-md-8 main-content m-post"><div id=toc class=toc-article><div class=hamburger><div class=line></div><div class=line></div><div class=line></div></div><strong class=toc-title>文章目录</strong><div class=menu-inner><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#前言><span class=toc-number>1.</span> <span class=toc-text>前言</span></a></li></ol><li class="toc-item toc-level-1"><a class=toc-link href=#zookeeper><span class=toc-number></span> <span class=toc-text>zookeeper</span></a><ol class=toc-child><li class="toc-item toc-level-2"><a class=toc-link href=#修改配置文件><span class=toc-number>1.</span> <span class=toc-text>修改配置文件</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#大坑预防><span class=toc-number>2.</span> <span class=toc-text>大坑预防</span></a></li></ol></li><li class="toc-item toc-level-1"><a class=toc-link href=#服务开启><span class=toc-number></span> <span class=toc-text>服务开启</span></a></li><li class="toc-item toc-level-1"><a class=toc-link href=#友情提醒><span class=toc-number></span> <span class=toc-text>友情提醒</span></a></li><li class="toc-item toc-level-1"><a class=toc-link href=#Kafka集群配置><span class=toc-number></span> <span class=toc-text>Kafka集群配置</span></a><ol class=toc-child><li class="toc-item toc-level-2"><a class=toc-link href=#server-properties修改><span class=toc-number>1.</span> <span class=toc-text>server.properties修改</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#服务启动前的命令准备><span class=toc-number>2.</span> <span class=toc-text>服务启动前的命令准备</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#大坑预防-1><span class=toc-number>3.</span> <span class=toc-text>大坑预防</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#服务开启-1><span class=toc-number>4.</span> <span class=toc-text>服务开启</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#创建Topic批处理><span class=toc-number>5.</span> <span class=toc-text>创建Topic批处理</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#消息处理><span class=toc-number>6.</span> <span class=toc-text>消息处理</span></a></li></ol></li></div><svg version=1.1 id=blob xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><path id=blob-path d=M60,500H0V0h60c0,0,20,172,20,250S60,900,60,500z></path></svg></div><p id=process></p><article class=post><div class=post-head><h1 id=Kafka集群配置---Windows版>Kafka集群配置---Windows版</h1><div class=post-meta><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <span>编程</span></span> <span class=fa-wrap><i class="fa fa-tags"></i> <span class=tags-meta>java</span></span> <span class=fa-wrap><i class="fa fa-clock-o"></i> <span class=date-meta>2017/04/10</span></span> <a href=/zxh/20170410.html#comments class=comment-count><i id=changyan_count_unit data-xid=zxh/20170410.html></i>留言, <i id=changyan_parti_unit data-xid=zxh/20170410.html></i>参与</a> <span id=busuanzi_container_page_pv>view : <span id=busuanzi_value_page_pv></span>次</span></div></div><div class="post-body post-content"><p>Kafka是一种高吞吐量的分布式发布订阅的消息队列系统<br><a id=more></a></p><pre><code>Kafka是一种高吞吐量的分布式发布订阅的消息队列系统，Kafka对消息进行保存时是通过tipic进行分组的。今天我们仅实现Kafka集群的配置。理论的抽空在聊
</code></pre><h2 id=前言><a href=#前言 class=headerlink title=前言></a>前言</h2><ul><li>最近研究kafka，发现网上很多关于kafka的介绍都是基于Linux操作系统的。虽然这些服务最后都是配置Linux上的。但是我们平时使用的大多都是Windows系统。所以研究很是吃力。经过借鉴不同的网络文章终于在Windows上实现了kafka的配置。在这里现在的配置是基于Zookeeper 3.4.6 版本的。如果读者在操作希望能和我的版本保持一致。</li></ul><h1 id=zookeeper><a href=#zookeeper class=headerlink title=zookeeper></a>zookeeper</h1><ul><li><p>了解kafka的都知道。kafka是通过Zookeeper实现分布操作的。不管是broker，consumer,还是provide信息都是存储在Zookeeper中的。当broker挂掉都是Zookeeper来进行重新分配选择的。所以实现kafka集群前我们得先实现Zookeeper的集群配置。</p></li><li><p>首先我们从官网上下载Zookeeper到本地。我这里下载的是Zookeeper-3.4.6.tar.gz版本的。读者可以根据自己情况下载。下载好之后进行文件解压。然后找到conf文件中的zoo_sample.cfg文件。该文件是Zookeeper官网给我们提供的一套样板。我们赋值该文件到同级下并改名为zoo.cfg.如下图</p></li></ul><p><img src="http://img.blog.csdn.net/20170331155731286?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><h2 id=修改配置文件><a href=#修改配置文件 class=headerlink title=修改配置文件></a>修改配置文件</h2><font color=gray>然后我们来看看这个配置文件里面都有些啥</font><pre><code>tickTime=2000
</code></pre><ul><li>服务器之间或客户端与服务端之间维持心跳的时间。就是每隔tickTime就会发送一次心跳。单位毫秒</li></ul><pre><code>initLimit=10
</code></pre><ul><li>这个是配置Zookeeper接收客户端初始化连接最长能忍受initLimit心跳时间间隔。</li></ul><pre><code>syncLimit=5
</code></pre><ul><li>Leader与follow之间发送消息和应答的时间 总时间=syncLimit*tickTime</li></ul><pre><code>dataDir
</code></pre><ul><li>zookeeper数据保持路径 默认将log日志也保存在dataDir</li></ul><pre><code>dataLogDir
</code></pre><ul><li>zookeeper log日志保存地址 不设置默认是dataDir</li></ul><pre><code>clientPort=2181
</code></pre><ul><li>客户端连接的端口</li></ul><pre><code>server.1=192.168.1.130:28881:38881
server.2=192.168.1.130:28882:38882
server.3=192.168.1.130:28883:38883
</code></pre><ul><li>因为我的集群都是在同一台电脑上配置的，所以这里端口不能一样</li></ul><hr><font color=gray>知道配置文件里的意思应该就知道如何修改了吧</font><ul><li>对于新手我们只需要该以下地方呢。</li></ul><pre><code>dataDir+dataLogDir+clientPort
</code></pre><ul><li>但是下面的server是Zookeeper配置里需要重点讲解的部分<br>上面的格式我们可以简单的总结为 server.num=B:C:D。<br>num：是正整数代表的服务的唯一标识。这个要和后面说道的myid文件保持一致。</li></ul><p>B： 标识Zookeeper集群中某一个服务的ip或者域名 192.168.1.130</p><p>C：表示server.num这个服务于集群中leader进行信息交流的端口。在kafka中我们leader和follower需要进行数据备份。具体服务就是通过这个地方制定的端口进行通信的。</p><p>D：表示万一leader宕机了，我们就通过这个端口来进行再follower中选举新的leader。</p><h2 id=大坑预防><a href=#大坑预防 class=headerlink title=大坑预防></a>大坑预防</h2><ul><li><p>网上的很多教程也就介绍到这里。稍微好点就提了一下创建myid文件的事，我当时就纠结在这里。因为我根本不知道穿件的myid的类型。我就随便创建txt文件。结果是错的。这里我们创建myid我有两种方式。还有myid里面的内容就是我们对应的配置文件中server.num中的num。</p></li><li><p>第一种就是我们通过cmd窗口到我们要创建myid的文件夹下<br>执行如下命令</p></li></ul><pre><code>echo 1 &gt; myid
</code></pre><p><img src="http://img.blog.csdn.net/20170331161705249?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li><p>第二种是我们先创建TXT文件将对应的内容写入。然后txt后缀删掉就可以了。</p></li><li><p>顺便提一下myid应该放在我们conf/zoo.cfg文件中指定的dataDir 的对应的文件路径下。</p></li></ul><h1 id=服务开启><a href=#服务开启 class=headerlink title=服务开启></a>服务开启</h1><ul><li><p>所谓的集群就是讲上面的Zookeeper复制成多个，将上面提到的几个重要的属性更改掉就行了。</p></li><li><p>如果你到这一步说明你离成功已经不远了。下面我们只需要开启服务就行了。开启服务在我们解压的bin目录下。</p></li></ul><p><img src="http://img.blog.csdn.net/20170331162134910?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>这里我们得有些常识，已sh结尾的是Linux 系统的shell文件。在windows上没有装插件是无法使用的。我们windows认识的就是bat文件。就是上面的cmd结尾才是我们可以用的功能。但是我们还需要进行一下修改。其实这里已经可以了。我们到cmd窗口中通过该命令去执行我们zoo.cfg文件。但是为了方便我们这里讲zoo.cfg配置进我们的zkServer.cmd文件中</li></ul><p><img src="http://img.blog.csdn.net/20170331162449799?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>好了。配置完成。我们只需要每次点击zkServer.cmd就开启了Zookeeper中的服务了。</li></ul><h1 id=友情提醒><a href=#友情提醒 class=headerlink title=友情提醒></a>友情提醒</h1><ul><li><p>上面我们配置的Zookeeper在开启第一个时候回报错。为什么呢。原因就是我们开启了一个服务，。但是我们的配置文件配置的是集群的信息。这个时候就回去寻找其他服务。但是这个时候其他的服务还没有开启呢。所以这个错误是正常。等我们集群中的所有的服务都开启了就不会报错。这里大家不要被吓到。</p></li><li><p>除此之外，还有一点就是Zookeeper的安装目录(解压目录)是绝对<font color=red>不能包含汉字</font>的。我上面的截图有汉字那是我计算机上设置的。实际的路径是没有汉字的。不要被上面的图片诱导。</p></li><li><p>当所有的服务都开启了，我们如何查看我们的服务是否开启成功呢。这很简单。我们重新打开一个新的cmd窗口。直接执行jps就可以看到我们的服务了。QuorumPeerMain就是我们的服务主类</p></li></ul><p><img src="http://img.blog.csdn.net/20170331163035162?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><h1 id=Kafka集群配置><a href=#Kafka集群配置 class=headerlink title=Kafka集群配置></a>Kafka集群配置</h1><ul><li>上面我们就完成了Zookeeper的集群的配置。实际上Kafka中就自带有Zookeeper的服务。但是为了数据的高可用性。我们最好选择自己搭建Zookeeper集群。这也是官网上的建议。</li><li><p>这里我的Kafka版本选择的是0.8.1.1。建议单价不要选择太高的版本。刚出的版本可能有未知的bug。</p></li><li><p>同样这里的集群就是讲Kafka复制多个。这里我选择其中一个进行讲解。其他的都是一样的主要就是讲端口改掉就行了。</p></li><li><p>将官网下载的Kafka解压改名为kafka1（其他的改名数字递增就行。或者自定义别的名字）。找到config/server.properties文件。</p></li></ul><h2 id=server-properties修改><a href=#server-properties修改 class=headerlink title=server.properties修改></a>server.properties修改</h2><font color=gray>同样的先来了解里面的参数含义吧</font><pre><code>broker.id=1
</code></pre><ul><li>在kafka这个集群中的唯一标识，且只能是正整数</li></ul><pre><code>port=9091
</code></pre><ul><li>该服务监听的端口</li></ul><pre><code>host.name=192.168.1.130
</code></pre><ul><li>broker 绑定的主机名称(IP) 如果不设置将绑定所有的接口。</li></ul><pre><code>advertised.host.name=192.168.1.130
</code></pre><ul><li>broker服务将通知消费者和生产者 换言之，就是消费者和生产者就是通过这个主机(IP)来进行通信的。如果没有设置就默认采用host.name。</li></ul><pre><code>num.network.threads=2
</code></pre><ul><li>broker处理消息的最大线程数，一般情况是CPU的核数</li></ul><pre><code>num.io.threads=8
</code></pre><ul><li>broker处理IO的线程数 一般是num.network.threads的两倍</li></ul><pre><code>socket.send.buffer.bytes=1048576
</code></pre><ul><li>socket发送的缓冲区。socket调优参数SO_SNDBUFF</li></ul><pre><code>socket.receive.buffer.bytes=1048576
</code></pre><ul><li>socket接收的缓冲区 socket的调优参数SO_RCVBUF</li></ul><pre><code>socket.request.max.bytes=104857600
</code></pre><ul><li>socket请求的最大数量，防止serverOOM。</li></ul><pre><code>log.dirs=\logs
</code></pre><ul><li>kafka数据的存放地址，多个地址的话用逗号隔开。多个目录分布在不同的磁盘上可以提高读写性能</li></ul><pre><code>num.partitions=2
</code></pre><ul><li>每个tipic的默认分区个数，在创建topic时可以重新制定</li></ul><pre><code>log.retention.hours=168
</code></pre><ul><li>数据文件的保留时间 log.retention.minutes也是一个道理。</li></ul><pre><code>log.segment.bytes=536870912
</code></pre><ul><li>topic中的最大文件的大小 -1表示没有文件大小限制 log.segment.bytes 和log.retention.minutes 任意一个<br>达到要求 都会删除该文件 在创建topic时可以重新制定。若没有.则选取该默认值</li></ul><pre><code>log.retention.check.interval.ms=60000
</code></pre><ul><li>文件大小检查的周期时间，是否处罚 log.cleanup.policy中设置的策略</li></ul><pre><code>log.cleaner.enable=false
</code></pre><ul><li>是否开启日志清理</li></ul><pre><code>zookeeper.connect=192.168.1.130:num1,192.168.1.130:num2,192.168.1.130:num3
</code></pre><ul><li>上面我们的Zookeeper集群</li></ul><pre><code>zookeeper.connection.timeout.ms=1000000
</code></pre><ul><li>进群链接时间超时</li></ul><hr><ul><li>同样的我们每次赋值kafka服务我们只需该配置文件里的下面两个属性就行了。</li></ul><pre><code>broker.id  +  port
</code></pre><h2 id=服务启动前的命令准备><a href=#服务启动前的命令准备 class=headerlink title=服务启动前的命令准备></a>服务启动前的命令准备</h2><ul><li><p>同样的我们观察bin目录中我们会发现Kafka针对Linux和windows提供了不同的组件。windows的组件放在了windows的文件夹下了。但是我在实际操作中无法使用里面的命令。报一些错误。这里我的解决办法是将windows里的bat全部复制到外面。就是复制到bin目录下。<br><img src="http://img.blog.csdn.net/20170331165149109?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p></li><li><p>上图中指出来的bat原本是在windows文件中。拷贝到bin目录之后我们需要修改一下kafka-run-class.bat文件。因为里面写的相对路径和引入的jar会导致出错。所以我们将里面的这段代码</p></li></ul><pre><code>set ivyPath=%USERPROFILE%\.ivy2\cache

set snappy=%ivyPath%/org.xerial.snappy/snappy-java/bundles/snappy-java-1.0.5.jar
     call :concat %snappy%

set library=%ivyPath%/org.scala-lang/scala-library/jars/scala-library-2.8.0.jar
     call :concat %library%

set compiler=%ivyPath%/org.scala-lang/scala-compiler/jars/scala-compiler-2.8.0.jar
     call :concat %compiler%

set log4j=%ivyPath%/log4j/log4j/jars/log4j-1.2.15.jar
     call :concat %log4j%

set slf=%ivyPath%/org.slf4j/slf4j-api/jars/slf4j-api-1.6.4.jar
     call :concat %slf%

set zookeeper=%ivyPath%/org.apache.zookeeper/zookeeper/jars/zookeeper-3.3.4.jar
     call :concat %zookeeper%

set jopt=%ivyPath%/net.sf.jopt-simple/jopt-simple/jars/jopt-simple-3.2.jar
     call :concat %jopt%

for %%i in (%BASE_DIR%\core\target\scala-2.8.0\*.jar) do (
     call :concat %%i
)

for %%i in (%BASE_DIR%\core\lib\*.jar) do (
     call :concat %%i
)

for %%i in (%BASE_DIR%\perf\target\scala-2.8.0/kafka*.jar) do (
     call :concat %%i
)
</code></pre><ul><li>替换成</li></ul><pre><code>for %%i in (%BASE_DIR%\libs\*.jar) do (
     call :concat %%i
)
</code></pre><ul><li>我们仔细观察原来的配置大概意思是引入一些jar包啥的。但是会出现有的时候我们的文件根本没有那个jar。但是又引入了。会经常报错。所以我们改成引入libs下的所有jar.有啥就引入啥。这样就不会报错的。</li></ul><h2 id=大坑预防-1><a href=#大坑预防-1 class=headerlink title=大坑预防></a>大坑预防</h2><ul><li>到这里我原本天真的认为就已经完事了。但是谁知我按照网上的教程继续的时候就出现如下错误</li></ul><p><img src="http://img.blog.csdn.net/20170331165700492?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>首先第一行提示 set JMX_PORT to default value 9999 这个错误是因为我没有设置这个值。这倒是小事。但是后面报说找不到或无法加载主类kafka.Kafka这就让我费解。在这里我也是卡了一天了。后来在网上找到了一个方法。我不知道这是不是Kafka的bug。反正用这个方法我是解决了这个错误了。</li></ul><ul><li>解决办法就是将kafka-run-class.bat文件中</li></ul><pre><code>set COMMAND= %JAVA% %KAFKA_OPTS% %KAFKA_JMX_OPTS% -cp %CLASSPATH% %*
</code></pre><ul><li>修改为</li></ul><pre><code>set COMMAND= %JAVA% %KAFKA_OPTS% %KAFKA_JMX_OPTS% -cp &quot;%CLASSPATH%&quot; %*
</code></pre><ul><li>对比我们发现就是将classpath加上双引号。搞了半天就是系统变量路径没有找到的原因。不过这个问题值得引起我们的注意。我们的kafka寄去你的搭建实在Java 的jdk基础是搭建的。所以前提我们得将jdk等这些配置到环境变量中去。这里的配置网上搜去吧很多。</li></ul><h2 id=服务开启-1><a href=#服务开启-1 class=headerlink title=服务开启></a>服务开启</h2><ul><li><p>到这一步我们离kafka的成功又不远了。我们新开cmd窗口cd到kafka的bin目录中。</p></li><li><p>但是在执行开启之前我们需要先执行</p></li></ul><pre><code>Set JMX_PORT=19091(每个服务数字不能一样)
</code></pre><ul><li>然后在执行</li></ul><pre><code>kafka-server-start.bat ..\config\server.properties
</code></pre><h2 id=创建Topic批处理><a href=#创建Topic批处理 class=headerlink title=创建Topic批处理></a>创建Topic批处理</h2><ul><li>官网上是没有提供windows版本的topic处理程序的。我们需要自己新建一个bat文件。这个bat文件的内容填写如下</li></ul><pre><code>kafka-run-class.bat  kafka.admin.TopicCommand  %*
</code></pre><p><img src="http://img.blog.csdn.net/20170331170713381?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><h2 id=消息处理><a href=#消息处理 class=headerlink title=消息处理></a>消息处理</h2><ul><li>有了这个批处理我们就可以通过它实现topic的创建。生产者发送消息和消费者的接收消息</li></ul><font face=楷体 color=red>创建Topic</font><ul><li>replication-factor：表示该topic需要在不同的broker中保存</li><li>partitions ： 对该top的分区数量</li><li>topic ： 该top的名称。建议指定。否则采用默认<pre><code>kafka-topics.bat --create --zookeeper 192.168.1.130:2181 --replication-factor 2 --partitions 3 --topic my-replicated-topic
</code></pre></li></ul><font face=楷体 color=red>查看Topic</font><pre><code>kafka-topics.bat --describe --zookeeper 192.168.1.130:2181 --topic my-replicated-topic
</code></pre><font face=楷体 color=red>生产topic消息</font><pre><code>kafka-console-producer.bat --broker-list 192.168.1.130:9093 --topic my-replicated-topic
</code></pre><font face=楷体 color=red>消费topic消息</font><pre><code>kafka-console-consumer.bat --zookeeper 192.168.1.130:2181 --from-beginning --topic my-replicated-topic
</code></pre><ul><li>最后在接收发送消息是我们需要重新创建新的cmd窗口。下面看看效果图。最终实现实时接收消息</li></ul><p><img src="http://img.blog.csdn.net/20170331174451934?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><hr><font color=blue>资源由于大小限制暂时无法上传！后续再上传</font></div><div class=post-footer><div>转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a target=_blank>烟花散尽13141</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href=/zxh/20170416.html class="pre-post btn btn-default"><i class="fa fa-angle-left fa-fw"></i>上一篇</a> <a href=/zxh/20170401.html class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a></div><div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div><button id=rewardButton disable=enable onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}"><span>赏</span></button><div id=QR style="display: none;"><div id=wechat style="display: inline-block"><a href=/img/wechatpay.jpg class="fancybox fancybox.image" rel=group><img id=wechat_qr src=/img/wechatpay.jpg alt="颜敏 WeChat Pay"></a><p>微信打赏</p></div><div id=alipay style="display: inline-block"><a href=/img/alipay.jpg class="fancybox fancybox.image" rel=group><img id=alipay_qr src=/img/alipay.jpg alt="颜敏 Alipay"></a><p>支付宝打赏</p></div></div></div><div id=comments><div id=SOHUCS sid=/zxh/20170410.html></div><script type=text/javascript> 
    (function(){ 
    var appid = 'cyti5JvoU'; 
    var conf = 'prod_a32310aad07e12c7706c8da1901ed57b'; 
    var width = window.innerWidth || document.documentElement.clientWidth; 
    if (width < 960) { 
    window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script></div></main><aside class="col-md-4 sidebar"><div class=widget><h3 class=title>Search</h3><div id=search-form><div id=result-mask class=hide></div><div class=search-area><input id=search-key type=search autocomplete=off placeholder=搜点什么呢?> <button type=button class=search-form-submit id=search-local>站内搜索</button></div><div id=result-wrap class=hide><div id=search-result></div></div><div class=hide><template id=search-tpl><div class=item><a href=/{path} title={title}><div class=title>{title}</div><div class=content>{content}</div></a></div></template></div></div></div><div class="widget notification"><h3 class=title>网站公告</h3><div><p><font color=red>pc、移动端目录区分设计</font></p></div></div><div class=widget><h3 class=title>Social</h3><div class="content social"><a href=//gitee.com/zxhtom rel="external nofollow" title=oschina target=_blank><i class="git fa fa-git"></i></a> <a href=mailto:870775401@qq.com rel="external nofollow" title=邮箱 target=_blank><i class="envelope-o fa fa-envelope-o"></i></a> <a href=870775401 rel="external nofollow" title=联系QQ target=_blank><i class="qq fa fa-qq"></i></a> <a href="/" rel="external nofollow" title=微博 target=_blank><i class="weibo fa fa-weibo"></i></a> <a href=376091466 rel="external nofollow" title=QQ群1 target=_blank><i class="users fa fa-users"></i></a> <a href=/atom.xml rel="external nofollow" title=RSS target=_blank><i class="feed fa fa-feed"></i></a></div></div><div class=widget><h3 class=title>Categories</h3><ul class=category-list><li class=category-list-item><a class=category-list-link href="/categories/开发工具/"><i class=fa aria-hidden=true>开发工具</i></a><span class=category-list-count>3</span></li><li class=category-list-item><a class=category-list-link href="/categories/案例/"><i class=fa aria-hidden=true>案例</i></a><span class=category-list-count>2</span></li><li class=category-list-item><a class=category-list-link href="/categories/程序人生/"><i class=fa aria-hidden=true>程序人生</i></a><span class=category-list-count>3</span></li><li class=category-list-item><a class=category-list-link href="/categories/编程/"><i class=fa aria-hidden=true>编程</i></a><span class=category-list-count>88</span></li></ul></div><div class=widget><h3 class=title>Archives</h3><ul class=archive-list><li class=archive-list-item><a class=archive-list-link href="/archives/2018/01/"><i class=fa aria-hidden=true>2018年01月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/12/"><i class=fa aria-hidden=true>2017年12月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/11/"><i class=fa aria-hidden=true>2017年11月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/10/"><i class=fa aria-hidden=true>2017年10月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/06/"><i class=fa aria-hidden=true>2017年06月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/04/"><i class=fa aria-hidden=true>2017年04月</i></a><span class=archive-list-count>5</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/03/"><i class=fa aria-hidden=true>2017年03月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/02/"><i class=fa aria-hidden=true>2017年02月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/01/"><i class=fa aria-hidden=true>2017年01月</i></a><span class=archive-list-count>9</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/12/"><i class=fa aria-hidden=true>2016年12月</i></a><span class=archive-list-count>7</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/11/"><i class=fa aria-hidden=true>2016年11月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/10/"><i class=fa aria-hidden=true>2016年10月</i></a><span class=archive-list-count>8</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/09/"><i class=fa aria-hidden=true>2016年09月</i></a><span class=archive-list-count>6</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/08/"><i class=fa aria-hidden=true>2016年08月</i></a><span class=archive-list-count>7</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/07/"><i class=fa aria-hidden=true>2016年07月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/06/"><i class=fa aria-hidden=true>2016年06月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/05/"><i class=fa aria-hidden=true>2016年05月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/04/"><i class=fa aria-hidden=true>2016年04月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/03/"><i class=fa aria-hidden=true>2016年03月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/02/"><i class=fa aria-hidden=true>2016年02月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2015/04/"><i class=fa aria-hidden=true>2015年04月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/11/"><i class=fa aria-hidden=true>2014年11月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/10/"><i class=fa aria-hidden=true>2014年10月</i></a><span class=archive-list-count>6</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/04/"><i class=fa aria-hidden=true>2014年04月</i></a><span class=archive-list-count>5</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/01/"><i class=fa aria-hidden=true>2014年01月</i></a><span class=archive-list-count>2</span></li></ul></div><div class=widget><h3 class=title>Tag Cloud</h3><div class="content tag-cloud"><a href="/tags/C/" style="font-size: 17.5px;">C++</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/bat语法/" style="font-size: 10px;">bat语法</a> <a href="/tags/formatter/" style="font-size: 10px;">formatter</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/log4j2/" style="font-size: 10px;">log4j2</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mybatis/" style="font-size: 10px;">mybatis</a> <a href="/tags/ngrok/" style="font-size: 10px;">ngrok</a> <a href="/tags/nodejs/" style="font-size: 12.5px;">nodejs</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/sublime-text3/" style="font-size: 10px;">sublime text3</a> <a href="/tags/前端/" style="font-size: 12.5px;">前端</a> <a href="/tags/命令/" style="font-size: 10px;">命令</a> <a href="/tags/感慨/" style="font-size: 12.5px;">感慨</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a></div></div><div class=widget><h3 class=title>Friends</h3><div class="content friends-link"><a href=http://blog.csdn.net/u013132051 class=fa target=_blank>个人博客</a></div></div></aside></div></div></section><footer class=main-footer><div class=container><div class=row></div></div></footer><a id=back-to-top class=hide><i class="fa fa-chevron-up"></i></a><div class=copyright><div class=container><div class=row><div class=col-sm-12><span>Copyright &copy; 2017</span> | <span>Powered by <a href=//hexo.io class=copyright-links target=_blank rel=nofollow>张新华</a></span> | <span>Theme by <a href=//github.com/shenliyang/hexo-theme-snippet.git class=copyright-links target=_blank rel=nofollow>ZxhTom</a></span></div></div></div></div><script src=https://code.jquery.com/jquery-latest.js></script><script src=https://assets.changyan.sohu.com/upload/plugins/plugins.count.js></script><script src="/assets/highlight.pack.js?rev=@@hash"></script><script>
     hljs.initHighlightingOnLoad(); //初始化代码高亮 
  </script><script src="/js/search.js?rev=@@hash"></script><script src="/js/app.js?rev=@@hash"></script><script src="/assets/prefix.js?rev=@@hash"></script><script src="/assets/my.js?rev=@@hash"></script></body></html>