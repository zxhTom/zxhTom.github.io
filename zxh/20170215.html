<!DOCTYPE HTML><html><head><script>
	if('' == 'true'){
		if (prompt('请输入管理员密码') !== '025025'){
            alert('密码错误！');
            location.href='https://zxhtom.oschina.io';
    	}
	}
</script><meta charset=UTF-8><meta name=viewport content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><meta http-equiv=X-UA-Compatible content="IE=Edge,chrome=1"><meta http-equiv=Cache-Control content=no-siteapp><meta name=renderer content=webkit|ie-comp|ie-stand><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><meta name=format-detection content="telephone=no,email=no,adress=no"><meta name=browsermode content=application><meta name=screen-orientation content=portrait><link rel=dns-prefetch href=https://zxhtom.oschina.io><meta name=description content=张新华的个人网站><meta name=robots content=all><meta name=google content=all><meta name=googlebot content=all><meta name=verify content=all><title>微信开发--开发模式简单配置 | 烟花散尽13141</title><link rel=alternate href=/atom.xml title=烟花散尽13141 type=application/atom+xml><link rel=icon href=/favicon.ico><link rel=stylesheet href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css?rev=9.12.0"><link rel=stylesheet href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4"><link rel=stylesheet href=//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href="/css/style.css?rev=@@hash"><link rel=stylesheet href="/css/mycss.css?rev=@@hash"><div class=hide><script src="https://s4.cnzz.com/z_stat.php?id=1263868967&web_id=1263868967" language=JavaScript></script></div><script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?709c2dde1f61f5e589ff3ed31ba52411";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script></head><body><header class=main-header style=background-image:url(http://7xpw2b.com1.z0.glb.clouddn.com/hexo-sinppet/img/banner2.jpg)><div class=main-header-box><a class=header-avatar href="/"><img src=/img/avatar.jpg alt=logo头像></a><div class=branding><h2>学如逆水行舟，不进则退！！！</h2></div></div></header><nav class=main-navigation><div class=container><div class=row><div class=col-sm-12><div class=navbar-header><span class="nav-toggle-button collapsed" data-toggle=collapse data-target=#main-menu id=mnav><span class=sr-only>Toggle navigation</span> <i class="fa fa-bars"></i></span></div><div class="collapse navbar-collapse" id=main-menu><ul class=menu><li role=presentation><a href="/"><i class="fa fa-fw"></i>首页</a></li><li role=presentation><a href="/about/"><i class="fa fa-fw"></i>关于我</a></li><li role=presentation><a href="/tags/"><i class="fa fa-fw"></i>标签</a></li><li role=presentation><a href="/categories/"><i class="fa fa-fw"></i>分类</a></li><li role=presentation><a href="/archives/"><i class="fa fa-fw"></i>归档</a></li><li role=presentation><a href="/schedule/"><i class="fa fa-fw"></i>日程表</a></li><li role=presentation><a href=/sitemap.xml><i class="fa fa-fw"></i>地图导航</a></li><li role=presentation><a href="/404/"><i class="fa fa-fw"></i>公益活动</a></li></ul></div></div></div></div></nav><section class=content-wrap><div class=container><div class=row><main class="col-md-8 main-content m-post"><div id=toc class=toc-article><div class=hamburger><div class=line></div><div class=line></div><div class=line></div></div><strong class=toc-title>文章目录</strong><div class=menu-inner><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#开启开发者模式><span class=toc-number>1.</span> <span class=toc-text>开启开发者模式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#新浪云申请><span class=toc-number>2.</span> <span class=toc-text>新浪云申请</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#微信开发者配置><span class=toc-number>3.</span> <span class=toc-text>微信开发者配置</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#微信服务器的代码编写><span class=toc-number>4.</span> <span class=toc-text>微信服务器的代码编写</span></a></li></ol></div><svg version=1.1 id=blob xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><path id=blob-path d=M60,500H0V0h60c0,0,20,172,20,250S60,900,60,500z></path></svg></div><p id=process></p><article class=post><div class=post-head><h1 id=微信开发--开发模式简单配置>微信开发--开发模式简单配置</h1><div class=post-meta><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <span>编程</span></span> <span class=fa-wrap><i class="fa fa-tags"></i> <span class=tags-meta>java</span></span> <span class=fa-wrap><i class="fa fa-clock-o"></i> <span class=date-meta>2017/02/15</span></span> <a href=/zxh/20170215.html#comments class=comment-count><i id=changyan_count_unit data-xid=zxh/20170215.html></i>留言, <i id=changyan_parti_unit data-xid=zxh/20170215.html></i>参与</a> <span id=busuanzi_container_page_pv>view : <span id=busuanzi_value_page_pv></span>次</span></div><p class="fa fa-exclamation-triangle warning">本文于<strong>338</strong>天之前发表，文中内容可能已经过时。</p></div><div class="post-body post-content"><p>微信用户量很多，那么我们如何开始一个属于自己的微信小程序呢<br><a id=more></a></p><blockquote><p>微信用户量很多，那么我们如何开始一个属于自己的微信小程序呢，因为自己不是高微信的。最近研究了一下微信，只是先微信的一个小功能。那么下面开始微信开发的搭建。这里如何申请微信公众号自己去官网申请就行了。最后登录该公众号。下面从我公众号开始讲</p></blockquote><h2 id=开启开发者模式><a href=#开启开发者模式 class=headerlink title=开启开发者模式></a>开启开发者模式</h2><ul><li>点击左侧菜单的基本配置</li></ul><p><img src="http://img.blog.csdn.net/20170215103140846?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>然后是做微信开发我们得有一个属于自己的服务器，方便在上面编写代码。这里我用新浪云作为自己的服务器。<br><a href="http://sae.sina.com.cn/" target=_blank rel=noopener>新浪云服务注册地址</a></li></ul><h2 id=新浪云申请><a href=#新浪云申请 class=headerlink title=新浪云申请></a>新浪云申请</h2><ul><li>进入新浪云后选择控制台sae</li></ul><p><img src="http://img.blog.csdn.net/20170215103919161?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>然后点击创建新应用 按钮 后弹出选择服务器的界面，我们选择标准版的，因为是免费的。</li></ul><p><img src="http://img.blog.csdn.net/20170215104059584?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>至于里面的二级域名这就是看个人喜好设置的了。设置好之后我们回到父页面，就是点击创建新应用的那个界面就会看到我们创建的应用了，我这里是我实现创立好的。</li></ul><p><img src="http://img.blog.csdn.net/20170215104242550?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><h2 id=微信开发者配置><a href=#微信开发者配置 class=headerlink title=微信开发者配置></a>微信开发者配置</h2><ul><li>通过上面我们就已经有了服务器了，下面我们来填写微信的相关配置</li></ul><p><img src="http://img.blog.csdn.net/20170215104434880?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li><p>上面的url就填写我们的新建的新浪云应用的地址，至于token随便你自己填写，只不过你得记住，因为在新浪云服务器里写代码的时候需要用到。</p></li><li><p>然后点击确定你的微信公众号就成为了开发者模式了。下面我们开始在服务器上实现我们的功能</p></li></ul><h2 id=微信服务器的代码编写><a href=#微信服务器的代码编写 class=headerlink title=微信服务器的代码编写></a>微信服务器的代码编写</h2><ul><li>点击我们的应用的连接进入应用界面</li></ul><p><img src="http://img.blog.csdn.net/20170215104744229?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>选择左侧菜单树种的应用后再点击代码管理，在右侧就可以看到应用的编辑代码超链接了，点击超链接</li></ul><p><img src="http://img.blog.csdn.net/20170215104921981?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p><ul><li>这里我们可以选择我们index.php进行代码的修改，或者是实现。直接将下面的代码赋值到你的服务器里</li></ul><pre><code>&lt;?php
/*
    新华工作室
    http://www.cnblogs.com/txw1958/
    CopyRight 2014 All Rights Reserved
*/

define(&quot;TOKEN&quot;, &quot;与微信配置中的token对应&quot;);

$wechatObj = new wechatCallbackapiTest();
if (!isset($_GET[&#39;echostr&#39;])) {
    $wechatObj-&gt;responseMsg();
}else{
    $wechatObj-&gt;valid();
}

class wechatCallbackapiTest
{
    //验证签名
    public function valid()
    {
        $echoStr = $_GET[&quot;echostr&quot;];
        $signature = $_GET[&quot;signature&quot;];
        $timestamp = $_GET[&quot;timestamp&quot;];
        $nonce = $_GET[&quot;nonce&quot;];
        $token = TOKEN;
        $tmpArr = array($token, $timestamp, $nonce);
        sort($tmpArr);
        $tmpStr = implode($tmpArr);
        $tmpStr = sha1($tmpStr);
        if($tmpStr == $signature){
            header(&#39;content-type:text&#39;);
            echo $echoStr;
            exit;
        }
    }

    //响应消息
    public function responseMsg()
    {
        $postStr = $GLOBALS[&quot;HTTP_RAW_POST_DATA&quot;];
        if (!empty($postStr)){
            $this-&gt;logger(&quot;R &quot;.$postStr);
            $postObj = simplexml_load_string($postStr, &#39;SimpleXMLElement&#39;, LIBXML_NOCDATA);
            $RX_TYPE = trim($postObj-&gt;MsgType);

            //消息类型分离
            switch ($RX_TYPE)
            {
                case &quot;event&quot;:
                    $result = $this-&gt;receiveEvent($postObj);
                    break;
                case &quot;text&quot;:
                    $result = $this-&gt;receiveText($postObj);
                    break;
                default:
                    $result = &quot;unknown msg type: &quot;.$RX_TYPE;
                    break;
            }
            $this-&gt;logger(&quot;T &quot;.$result);
            echo $result;
        }else {
            echo &quot;&quot;;
            exit;
        }
    }

    //接收事件消息
    private function receiveEvent($object)
    {
        $content = &quot;&quot;;
        switch ($object-&gt;Event)
        {
            case &quot;subscribe&quot;:
                $content = &quot;欢迎关注新华工作室 &quot;;
                $content .= (!empty($object-&gt;EventKey))?(&quot;\n来自二维码场景 &quot;.str_replace(&quot;qrscene_&quot;,&quot;&quot;,$object-&gt;EventKey)):&quot;&quot;;
                break;
            case &quot;unsubscribe&quot;:
                $content = &quot;取消关注&quot;;
                break;
            case &quot;SCAN&quot;:
                $content = &quot;扫描场景 &quot;.$object-&gt;EventKey;
                break;
            case &quot;CLICK&quot;:
                switch ($object-&gt;EventKey)
                {
                    case &quot;COMPANY&quot;:
                        $content = array();
                        $content[] = array(&quot;Title&quot;=&gt;&quot;多图文1标题&quot;, &quot;Description&quot;=&gt;&quot;&quot;, &quot;PicUrl&quot;=&gt;&quot;http://discuz.comli.com/weixin/weather/icon/cartoon.jpg&quot;, &quot;Url&quot; =&gt;&quot;http://m.cnblogs.com/?u=txw1958&quot;);
                        break;
                    default:
                        $content = &quot;点击菜单：&quot;.$object-&gt;EventKey;
                        break;
                }
                break;
            case &quot;LOCATION&quot;:
                $content = &quot;上传位置：纬度 &quot;.$object-&gt;Latitude.&quot;;经度 &quot;.$object-&gt;Longitude;
                break;
            case &quot;VIEW&quot;:
                $content = &quot;跳转链接 &quot;.$object-&gt;EventKey;
                break;
            case &quot;MASSSENDJOBFINISH&quot;:
                $content = &quot;消息ID：&quot;.$object-&gt;MsgID.&quot;，结果：&quot;.$object-&gt;Status.&quot;，粉丝数：&quot;.$object-&gt;TotalCount.&quot;，过滤：&quot;.$object-&gt;FilterCount.&quot;，发送成功：&quot;.$object-&gt;SentCount.&quot;，发送失败：&quot;.$object-&gt;ErrorCount;
                break;
            default:
                $content = &quot;receive a new event: &quot;.$object-&gt;Event;
                break;
        }
        if(is_array($content)){
            if (isset($content[0])){
                $result = $this-&gt;transmitNews($object, $content);
            }else if (isset($content[&#39;MusicUrl&#39;])){
                $result = $this-&gt;transmitMusic($object, $content);
            }
        }else{
            $result = $this-&gt;transmitText($object, $content);
        }

        return $result;
    }

    //接收文本消息
    private function receiveText($object)
    {
        $keyword = trim($object-&gt;Content);
        //多客服人工回复模式
        if (strstr($keyword, &quot;您好&quot;) || strstr($keyword, &quot;你好&quot;) || strstr($keyword, &quot;在吗&quot;)){
            $result = $this-&gt;transmitService($object);
        }
        //自动回复模式
        else{
            if (strstr($keyword, &quot;文本&quot;)){
                $content = &quot;这是个文本消息&quot;;
            }else if (strstr($keyword, &quot;单图文&quot;)){
                $content = array();
                $content[] = array(&quot;Title&quot;=&gt;&quot;单图文标题&quot;,  &quot;Description&quot;=&gt;&quot;单图文内容&quot;, &quot;PicUrl&quot;=&gt;&quot;http://discuz.comli.com/weixin/weather/icon/cartoon.jpg&quot;, &quot;Url&quot; =&gt;&quot;http://m.cnblogs.com/?u=txw1958&quot;);
            }else if (strstr($keyword, &quot;图文&quot;) || strstr($keyword, &quot;多图文&quot;)){
                $content = array();
                $content[] = array(&quot;Title&quot;=&gt;&quot;多图文1标题&quot;, &quot;Description&quot;=&gt;&quot;&quot;, &quot;PicUrl&quot;=&gt;&quot;http://discuz.comli.com/weixin/weather/icon/cartoon.jpg&quot;, &quot;Url&quot; =&gt;&quot;http://m.cnblogs.com/?u=txw1958&quot;);
                $content[] = array(&quot;Title&quot;=&gt;&quot;多图文2标题&quot;, &quot;Description&quot;=&gt;&quot;&quot;, &quot;PicUrl&quot;=&gt;&quot;http://d.hiphotos.bdimg.com/wisegame/pic/item/f3529822720e0cf3ac9f1ada0846f21fbe09aaa3.jpg&quot;, &quot;Url&quot; =&gt;&quot;http://m.cnblogs.com/?u=txw1958&quot;);
                $content[] = array(&quot;Title&quot;=&gt;&quot;多图文3标题&quot;, &quot;Description&quot;=&gt;&quot;&quot;, &quot;PicUrl&quot;=&gt;&quot;http://g.hiphotos.bdimg.com/wisegame/pic/item/18cb0a46f21fbe090d338acc6a600c338644adfd.jpg&quot;, &quot;Url&quot; =&gt;&quot;http://m.cnblogs.com/?u=txw1958&quot;);
            }else if (strstr($keyword, &quot;音乐&quot;)){
                $content = array();
                $content = array(&quot;Title&quot;=&gt;&quot;最炫民族风&quot;, &quot;Description&quot;=&gt;&quot;歌手：凤凰传奇&quot;, &quot;MusicUrl&quot;=&gt;&quot;http://121.199.4.61/music/zxmzf.mp3&quot;, &quot;HQMusicUrl&quot;=&gt;&quot;http://121.199.4.61/music/zxmzf.mp3&quot;);
            }else{
                $content = date(&quot;Y-m-d H:i:s&quot;,time()).&quot;\n&quot;.&quot;ID&quot;.$object-&gt;FromUserName.&quot;\n技术支持 新华工作室&quot;;
            }

            if(is_array($content)){
                if (isset($content[0][&#39;PicUrl&#39;])){
                    $result = $this-&gt;transmitNews($object, $content);
                }else if (isset($content[&#39;MusicUrl&#39;])){
                    $result = $this-&gt;transmitMusic($object, $content);
                }
            }else{
                $result = $this-&gt;transmitText($object, $content);
            }
        }

        return $result;
    }

    //回复文本消息
    private function transmitText($object, $content)
    {
        $xmlTpl = &quot;&lt;xml&gt;
&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;
&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;
&lt;CreateTime&gt;%s&lt;/CreateTime&gt;
&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;
&lt;Content&gt;&lt;![CDATA[%s]]&gt;&lt;/Content&gt;
&lt;/xml&gt;&quot;;
        $result = sprintf($xmlTpl, $object-&gt;FromUserName, $object-&gt;ToUserName, time(), $content);
        return $result;
    }

    //回复语音消息
    private function transmitVoice($object, $voiceArray)
    {
        $itemTpl = &quot;&lt;Voice&gt;
    &lt;MediaId&gt;&lt;![CDATA[%s]]&gt;&lt;/MediaId&gt;
&lt;/Voice&gt;&quot;;

        $item_str = sprintf($itemTpl, $voiceArray[&#39;MediaId&#39;]);

        $xmlTpl = &quot;&lt;xml&gt;
&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;
&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;
&lt;CreateTime&gt;%s&lt;/CreateTime&gt;
&lt;MsgType&gt;&lt;![CDATA[voice]]&gt;&lt;/MsgType&gt;
$item_str
&lt;/xml&gt;&quot;;

        $result = sprintf($xmlTpl, $object-&gt;FromUserName, $object-&gt;ToUserName, time());
        return $result;
    }

    //回复图文消息
    private function transmitNews($object, $newsArray)
    {
        if(!is_array($newsArray)){
            return;
        }
        $itemTpl = &quot;    &lt;item&gt;
        &lt;Title&gt;&lt;![CDATA[%s]]&gt;&lt;/Title&gt;
        &lt;Description&gt;&lt;![CDATA[%s]]&gt;&lt;/Description&gt;
        &lt;PicUrl&gt;&lt;![CDATA[%s]]&gt;&lt;/PicUrl&gt;
        &lt;Url&gt;&lt;![CDATA[%s]]&gt;&lt;/Url&gt;
    &lt;/item&gt;
&quot;;
        $item_str = &quot;&quot;;
        foreach ($newsArray as $item){
            $item_str .= sprintf($itemTpl, $item[&#39;Title&#39;], $item[&#39;Description&#39;], $item[&#39;PicUrl&#39;], $item[&#39;Url&#39;]);
        }
        $xmlTpl = &quot;&lt;xml&gt;
&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;
&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;
&lt;CreateTime&gt;%s&lt;/CreateTime&gt;
&lt;MsgType&gt;&lt;![CDATA[news]]&gt;&lt;/MsgType&gt;
&lt;ArticleCount&gt;%s&lt;/ArticleCount&gt;
&lt;Articles&gt;
$item_str&lt;/Articles&gt;
&lt;/xml&gt;&quot;;

        $result = sprintf($xmlTpl, $object-&gt;FromUserName, $object-&gt;ToUserName, time(), count($newsArray));
        return $result;
    }

    //回复音乐消息
    private function transmitMusic($object, $musicArray)
    {
        $itemTpl = &quot;&lt;Music&gt;
    &lt;Title&gt;&lt;![CDATA[%s]]&gt;&lt;/Title&gt;
    &lt;Description&gt;&lt;![CDATA[%s]]&gt;&lt;/Description&gt;
    &lt;MusicUrl&gt;&lt;![CDATA[%s]]&gt;&lt;/MusicUrl&gt;
    &lt;HQMusicUrl&gt;&lt;![CDATA[%s]]&gt;&lt;/HQMusicUrl&gt;
&lt;/Music&gt;&quot;;

        $item_str = sprintf($itemTpl, $musicArray[&#39;Title&#39;], $musicArray[&#39;Description&#39;], $musicArray[&#39;MusicUrl&#39;], $musicArray[&#39;HQMusicUrl&#39;]);

        $xmlTpl = &quot;&lt;xml&gt;
&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;
&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;
&lt;CreateTime&gt;%s&lt;/CreateTime&gt;
&lt;MsgType&gt;&lt;![CDATA[music]]&gt;&lt;/MsgType&gt;
$item_str
&lt;/xml&gt;&quot;;

        $result = sprintf($xmlTpl, $object-&gt;FromUserName, $object-&gt;ToUserName, time());
        return $result;
    }

    //回复多客服消息
    private function transmitService($object)
    {
        $xmlTpl = &quot;&lt;xml&gt;
&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;
&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;
&lt;CreateTime&gt;%s&lt;/CreateTime&gt;
&lt;MsgType&gt;&lt;![CDATA[transfer_customer_service]]&gt;&lt;/MsgType&gt;
&lt;/xml&gt;&quot;;
        $result = sprintf($xmlTpl, $object-&gt;FromUserName, $object-&gt;ToUserName, time());
        return $result;
    }

    //日志记录
    private function logger($log_content)
    {
        if(isset($_SERVER[&#39;HTTP_APPNAME&#39;])){   //SAE
            sae_set_display_errors(false);
            sae_debug($log_content);
            sae_set_display_errors(true);
        }else if($_SERVER[&#39;REMOTE_ADDR&#39;] != &quot;127.0.0.1&quot;){ //LOCAL
            $max_size = 10000;
            $log_filename = &quot;log.xml&quot;;
            if(file_exists($log_filename) and (abs(filesize($log_filename)) &gt; $max_size)){unlink($log_filename);}
            file_put_contents($log_filename, date(&#39;H:i:s&#39;).&quot; &quot;.$log_content.&quot;\r\n&quot;, FILE_APPEND);
        }
    }
}
?&gt;
</code></pre><ul><li><font face=楷体 size=5 color=red>token一定要和微信配置中的相同</font></li><li><p>然后让我们看看效果吧</p></li></ul><p><img src="http://img.blog.csdn.net/20170215132626415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzEzMjA1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=这里写图片描述></p></div><div class=post-footer><div>转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a target=_blank>烟花散尽13141</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href=/zxh/20170227.html class="pre-post btn btn-default"><i class="fa fa-angle-left fa-fw"></i>上一篇</a> <a href=/zxh/20170213.html class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a></div><div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div><button id=rewardButton disable=enable onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}"><span>赏</span></button><div id=QR style="display: none;"><div id=wechat style="display: inline-block"><a href=/img/wechatpay.jpg class="fancybox fancybox.image" rel=group><img id=wechat_qr src=/img/wechatpay.jpg alt="颜敏 WeChat Pay"></a><p>微信打赏</p></div><div id=alipay style="display: inline-block"><a href=/img/alipay.jpg class="fancybox fancybox.image" rel=group><img id=alipay_qr src=/img/alipay.jpg alt="颜敏 Alipay"></a><p>支付宝打赏</p></div></div></div><div id=comments><div id=SOHUCS sid=/zxh/20170215.html></div><script type=text/javascript> 
    (function(){ 
    var appid = 'cyti5JvoU'; 
    var conf = 'prod_a32310aad07e12c7706c8da1901ed57b'; 
    var width = window.innerWidth || document.documentElement.clientWidth; 
    if (width < 960) { 
    window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script></div></main><aside class="col-md-4 sidebar"><div class=widget><h3 class=title>Search</h3><div id=search-form><div id=result-mask class=hide></div><div class=search-area><input id=search-key type=search autocomplete=off placeholder=搜点什么呢?> <button type=button class=search-form-submit id=search-local>站内搜索</button></div><div id=result-wrap class=hide><div id=search-result></div></div><div class=hide><template id=search-tpl><div class=item><a href=/{path} title={title}><div class=title>{title}</div><div class=content>{content}</div></a></div></template></div></div></div><div class="widget notification"><h3 class=title>网站公告</h3><div><p><font color=red>pc、移动端目录区分设计</font></p></div></div><div class=widget><h3 class=title>Social</h3><div class="content social"><a href=//gitee.com/zxhtom rel="external nofollow" title=oschina target=_blank><i class="git fa fa-git"></i></a> <a href=mailto:870775401@qq.com rel="external nofollow" title=邮箱 target=_blank><i class="envelope-o fa fa-envelope-o"></i></a> <a href=870775401 rel="external nofollow" title=联系QQ target=_blank><i class="qq fa fa-qq"></i></a> <a href="/" rel="external nofollow" title=微博 target=_blank><i class="weibo fa fa-weibo"></i></a> <a href=376091466 rel="external nofollow" title=QQ群1 target=_blank><i class="users fa fa-users"></i></a> <a href=/atom.xml rel="external nofollow" title=RSS target=_blank><i class="feed fa fa-feed"></i></a></div></div><div class=widget><h3 class=title>Categories</h3><ul class=category-list><li class=category-list-item><a class=category-list-link href="/categories/开发工具/"><i class=fa aria-hidden=true>开发工具</i></a><span class=category-list-count>3</span></li><li class=category-list-item><a class=category-list-link href="/categories/案例/"><i class=fa aria-hidden=true>案例</i></a><span class=category-list-count>2</span></li><li class=category-list-item><a class=category-list-link href="/categories/程序人生/"><i class=fa aria-hidden=true>程序人生</i></a><span class=category-list-count>3</span></li><li class=category-list-item><a class=category-list-link href="/categories/编程/"><i class=fa aria-hidden=true>编程</i></a><span class=category-list-count>88</span></li></ul></div><div class=widget><h3 class=title>Archives</h3><ul class=archive-list><li class=archive-list-item><a class=archive-list-link href="/archives/2018/01/"><i class=fa aria-hidden=true>2018年01月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/12/"><i class=fa aria-hidden=true>2017年12月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/11/"><i class=fa aria-hidden=true>2017年11月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/10/"><i class=fa aria-hidden=true>2017年10月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/06/"><i class=fa aria-hidden=true>2017年06月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/04/"><i class=fa aria-hidden=true>2017年04月</i></a><span class=archive-list-count>5</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/03/"><i class=fa aria-hidden=true>2017年03月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/02/"><i class=fa aria-hidden=true>2017年02月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2017/01/"><i class=fa aria-hidden=true>2017年01月</i></a><span class=archive-list-count>9</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/12/"><i class=fa aria-hidden=true>2016年12月</i></a><span class=archive-list-count>7</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/11/"><i class=fa aria-hidden=true>2016年11月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/10/"><i class=fa aria-hidden=true>2016年10月</i></a><span class=archive-list-count>8</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/09/"><i class=fa aria-hidden=true>2016年09月</i></a><span class=archive-list-count>6</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/08/"><i class=fa aria-hidden=true>2016年08月</i></a><span class=archive-list-count>7</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/07/"><i class=fa aria-hidden=true>2016年07月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/06/"><i class=fa aria-hidden=true>2016年06月</i></a><span class=archive-list-count>4</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/05/"><i class=fa aria-hidden=true>2016年05月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/04/"><i class=fa aria-hidden=true>2016年04月</i></a><span class=archive-list-count>2</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/03/"><i class=fa aria-hidden=true>2016年03月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2016/02/"><i class=fa aria-hidden=true>2016年02月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2015/04/"><i class=fa aria-hidden=true>2015年04月</i></a><span class=archive-list-count>1</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/11/"><i class=fa aria-hidden=true>2014年11月</i></a><span class=archive-list-count>3</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/10/"><i class=fa aria-hidden=true>2014年10月</i></a><span class=archive-list-count>6</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/04/"><i class=fa aria-hidden=true>2014年04月</i></a><span class=archive-list-count>5</span></li><li class=archive-list-item><a class=archive-list-link href="/archives/2014/01/"><i class=fa aria-hidden=true>2014年01月</i></a><span class=archive-list-count>2</span></li></ul></div><div class=widget><h3 class=title>Tag Cloud</h3><div class="content tag-cloud"><a href="/tags/C/" style="font-size: 17.5px;">C++</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/bat语法/" style="font-size: 10px;">bat语法</a> <a href="/tags/formatter/" style="font-size: 10px;">formatter</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/log4j2/" style="font-size: 10px;">log4j2</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mybatis/" style="font-size: 10px;">mybatis</a> <a href="/tags/ngrok/" style="font-size: 10px;">ngrok</a> <a href="/tags/nodejs/" style="font-size: 12.5px;">nodejs</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/sublime-text3/" style="font-size: 10px;">sublime text3</a> <a href="/tags/前端/" style="font-size: 12.5px;">前端</a> <a href="/tags/命令/" style="font-size: 10px;">命令</a> <a href="/tags/感慨/" style="font-size: 12.5px;">感慨</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a></div></div><div class=widget><h3 class=title>Friends</h3><div class="content friends-link"><a href=http://blog.csdn.net/u013132051 class=fa target=_blank>个人博客</a></div></div></aside></div></div></section><footer class=main-footer><div class=container><div class=row></div></div></footer><a id=back-to-top class=hide><i class="fa fa-chevron-up"></i></a><div class=copyright><div class=container><div class=row><div class=col-sm-12><span>Copyright &copy; 2017</span> | <span>Powered by <a href=//hexo.io class=copyright-links target=_blank rel=nofollow>张新华</a></span> | <span>Theme by <a href=//github.com/shenliyang/hexo-theme-snippet.git class=copyright-links target=_blank rel=nofollow>ZxhTom</a></span></div></div></div></div><script src=https://code.jquery.com/jquery-latest.js></script><script src=https://assets.changyan.sohu.com/upload/plugins/plugins.count.js></script><script src="/assets/highlight.pack.js?rev=@@hash"></script><script>
     hljs.initHighlightingOnLoad(); //初始化代码高亮 
  </script><script src="/js/search.js?rev=@@hash"></script><script src="/js/app.js?rev=@@hash"></script><script src="/assets/prefix.js?rev=@@hash"></script><script src="/assets/my.js?rev=@@hash"></script></body></html>